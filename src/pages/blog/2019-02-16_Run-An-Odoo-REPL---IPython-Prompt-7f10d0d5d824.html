<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Run An Odoo REPL / IPython Prompt</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Run An Odoo REPL / IPython Prompt</h1>
</header>
<section data-field="subtitle" class="p-summary">
One of the most useful things in Odoo
</section>
<section data-field="body" class="e-content">
<section name="8920" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="4fb5" id="4fb5" class="graf graf--h3 graf--leading graf--title">Run An Odoo REPL / IPython Prompt</h3><h4 name="6071" id="6071" class="graf graf--h4 graf-after--h3 graf--subtitle">One of the most useful things in Odoo</h4><pre name="2be3" id="2be3" class="graf graf--pre graf-after--h4">$ ./odoo-bin shell \<br>      -c /etc/odoo.conf \<br>      --xmlrpc-port=8888 \<br>      --longpolling-port=8899 \<br>      -d odoo</pre><figure name="6b27" id="6b27" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*g7moUIimQkAxV-CwIbhcWg.gif" data-width="600" data-height="307" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*g7moUIimQkAxV-CwIbhcWg.gif"><figcaption class="imageCaption">Starting up the REPL prompt.</figcaption></figure><p name="e6cb" id="e6cb" class="graf graf--p graf-after--figure">In Odoo, you have the ability to run Odoo as a web server and access it via a GUI, but you can also run a python REPL with all of the Odoo modules loaded in as globals. This is extremely helpful for debugging and for learning.</p><p name="6a1d" id="6a1d" class="graf graf--p graf-after--p">For example, you could start up the shell, query for information via env/search/browse commands, run individual functions, access variables and properties associated with core classes, load in new functions if needed for testing, etc.</p><h3 name="4d72" id="4d72" class="graf graf--h3 graf-after--p">How to run an Odoo shell</h3><p name="47b6" id="47b6" class="graf graf--p graf-after--h3">Let’s break down the command:</p><pre name="716a" id="716a" class="graf graf--pre graf-after--p">$ ./odoo-bin shell \<br>      -c /etc/odoo.conf \<br>      --xmlrpc-port=8888 \<br>      --longpolling-port=8899 \<br>      -d odoo</pre><h4 name="8eca" id="8eca" class="graf graf--h4 graf-after--pre"><strong class="markup--strong markup--h4-strong">./odoo-bin shell</strong></h4><p name="79fe" id="79fe" class="graf graf--p graf-after--h4"><code class="markup--code markup--p-code">odoo-bin</code> is the executable in the root directory of the core Odoo project. This is how you run an Odoo instance.</p><p name="f18f" id="f18f" class="graf graf--p graf-after--p">If you run <code class="markup--code markup--p-code">odoo-bin help</code> you will see that we have a few different commands that we can run. One of those commands is <code class="markup--code markup--p-code">shell</code> which will start up our REPL.</p><figure name="fae9" id="fae9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SUnf-nmUXeFoPAuiqMrYZA.png" data-width="1072" data-height="383" src="https://cdn-images-1.medium.com/max/800/1*SUnf-nmUXeFoPAuiqMrYZA.png"></figure><h4 name="e082" id="e082" class="graf graf--h4 graf-after--figure"><strong class="markup--strong markup--h4-strong">-c /etc/odoo.conf</strong></h4><p name="dd06" id="dd06" class="graf graf--p graf-after--h4">Reference to your configuration files, if relevant. If you do not need all of your configurations and addons referenced then you can leave this off.</p><h4 name="fc68" id="fc68" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">--xmlrpc-port=8888 --longpolling-port=8899</strong></h4><p name="fb18" id="fb18" class="graf graf--p graf-after--h4">More optional flags. I use these because then I can run a standard Odoo instance on 8069/8072, but run a shell prompt at the same time on separate non-conflicting ports. You can use any open ports that you would like.</p><h4 name="0141" id="0141" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">-d odoo</strong></h4><p name="a7ca" id="a7ca" class="graf graf--p graf-after--h4">The database that you want to connect to. All Odoo shell prompts are connected to a single database at a time.</p><h3 name="a5b6" id="a5b6" class="graf graf--h3 graf-after--p">What do you have reference to?</h3><p name="7f12" id="7f12" class="graf graf--p graf-after--h3">Once you got a shell prompt up and running, then check out what you actually have reference to. You can see this by runnng <code class="markup--code markup--p-code">globals()</code>:</p><figure name="c8a6" id="c8a6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wyLbBsKEuVUjDQQmhxeibw.png" data-width="2702" data-height="1466" src="https://cdn-images-1.medium.com/max/800/1*wyLbBsKEuVUjDQQmhxeibw.png"></figure><p name="5e4f" id="5e4f" class="graf graf--p graf-after--figure">Here are some of the globals that I end up using the most often:</p><h4 name="c3cc" id="c3cc" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">self</strong></h4><pre name="2b8d" id="2b8d" class="graf graf--pre graf-after--h4">In [7]: self<br>Out[7]: res.users(1,)</pre><p name="d0c6" id="d0c6" class="graf graf--p graf-after--pre"><code class="markup--code markup--p-code">self</code> is a reference to the currently logged in user. By default, this is going to be id=1 (the admin user.)</p><h4 name="717a" id="717a" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">env</strong></h4><p name="1a11" id="1a11" class="graf graf--p graf-after--h4">A global reference to the <code class="markup--code markup--p-code">Environment</code> similar to if you would access it via <code class="markup--code markup--p-code">self.env</code> .</p><p name="96c1" id="96c1" class="graf graf--p graf-after--p">This is where we can start querying/accessing different data in the system:</p><pre name="a653" id="a653" class="graf graf--pre graf-after--p">In [8]: attachments = env[&#39;ir.attachment&#39;].search([])</pre><pre name="2059" id="2059" class="graf graf--pre graf-after--pre">In [9]: attachments<br>Out[9]: ir.attachment(356, 355, 354, 353, 352)</pre><h4 name="1dae" id="1dae" class="graf graf--h4 graf-after--pre"><strong class="markup--strong markup--h4-strong">odoo / openerp</strong></h4><p name="f7e5" id="f7e5" class="graf graf--p graf-after--h4">The global reference to the odoo core. Anything that you would typically import in modules is accessible. So if you need to access <code class="markup--code markup--p-code">odoo.models</code> , <code class="markup--code markup--p-code">odoo.tools</code> , <code class="markup--code markup--p-code">odoo.exceptions</code> , etc. you can import or reference those in the shell prompt.</p><pre name="703c" id="703c" class="graf graf--pre graf-after--p">In [11]: f = odoo.fields.Many2one</pre><pre name="046c" id="046c" class="graf graf--pre graf-after--pre">In [12]: dir(f)<br>Out[12]:<br>[&#39;__class__&#39;,<br> &#39;__delattr__&#39;,<br> &#39;__dir__&#39;,<br> &#39;__doc__&#39;,<br> &#39;__eq__&#39;,</pre><pre name="3efb" id="3efb" class="graf graf--pre graf-after--pre">... ]</pre><h3 name="0323" id="0323" class="graf graf--h3 graf-after--pre">Some Tricks</h3><p name="6cd7" id="6cd7" class="graf graf--p graf-after--h3">Here are just a couple of quick tricks that I use pretty often within the odoo shell.</p><h4 name="14e8" id="14e8" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">General Imports</strong></h4><p name="295a" id="295a" class="graf graf--p graf-after--h4">Just like any ipython prompt, you can import any accessible library. This is extremely helpful as you start debugging. Bring different libraries into the prompt.</p><pre name="a34a" id="a34a" class="graf graf--pre graf-after--p">In [14]: import math, string, io</pre><h4 name="1fbe" id="1fbe" class="graf graf--h4 graf-after--pre"><strong class="markup--strong markup--h4-strong">Viewing Properties and Functions</strong></h4><p name="c66f" id="c66f" class="graf graf--p graf-after--h4">At the beginning of this article, I said that the shell is great for both debugging and learning. Seeing the properties and functions available helped me initially learn how Odoo worked internally.</p><p name="1b8b" id="1b8b" class="graf graf--p graf-after--p">You can go through everything available to you via the global <code class="markup--code markup--p-code">odoo</code> or <code class="markup--code markup--p-code">env</code> module.</p><p name="58db" id="58db" class="graf graf--p graf-after--p">Let’s take the <code class="markup--code markup--p-code">search</code> method for example. This is something that many odoo developers use via commands like <code class="markup--code markup--p-code">env[&#39;my.model&#39;].search</code> . But we can see a quick description of this directly in the prompt by using <code class="markup--code markup--p-code">??</code> :</p><figure name="6afc" id="6afc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*I3W82EOninDM0ceFt5xvAA.png" data-width="2379" data-height="970" src="https://cdn-images-1.medium.com/max/800/1*I3W82EOninDM0ceFt5xvAA.png"></figure><p name="909b" id="909b" class="graf graf--p graf-after--figure">Above, we are assuming that we already know that the <code class="markup--code markup--p-code">search</code> method exists. If we actually need to find methods then we can hit tab at the end of a variable to see all available properties and methods:</p><figure name="22f3" id="22f3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*7zCziZifErGW5LIwsSArBA.gif" data-width="600" data-height="375" src="https://cdn-images-1.medium.com/max/800/1*7zCziZifErGW5LIwsSArBA.gif"></figure><h4 name="3dd6" id="3dd6" class="graf graf--h4 graf-after--figure"><strong class="markup--strong markup--h4-strong">Committing Data</strong></h4><p name="805c" id="805c" class="graf graf--p graf-after--h4"><strong class="markup--strong markup--p-strong">Be careful with this</strong> since it actually writes to your database.</p><p name="2690" id="2690" class="graf graf--p graf-after--p">If you need to update some record via the odoo shell, you have to run the <code class="markup--code markup--p-code">update</code> method like you would in a standard custom module, but then you have to manually commit them to the database via <code class="markup--code markup--p-code">env.cr.commit</code>.</p><pre name="d4d6" id="d4d6" class="graf graf--pre graf-after--p">In [23]: users = env[&#39;res.users&#39;].search([])</pre><pre name="381e" id="381e" class="graf graf--pre graf-after--pre">In [24]: for user in users:<br>    ...:     user.update({&#39;create_uid&#39;: 1, })<br>    ...:</pre><pre name="2395" id="2395" class="graf graf--pre graf-after--pre">In [25]: env.cr.commit()</pre><h3 name="2842" id="2842" class="graf graf--h3 graf-after--pre">Thanks For Reading</h3><p name="7341" id="7341" class="graf graf--p graf-after--h3">Go try it out and let me know how Odoo shell works for you or your team.</p><p name="05f2" id="05f2" class="graf graf--p graf-after--p"><a href="https://twitter.com/reedrehg" data-href="https://twitter.com/reedrehg" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Follow me on Twitter</a> for random thoughts and articles about Odoo. Or <a href="https://medium.com/@reedrehg" data-href="https://medium.com/@reedrehg" class="markup--anchor markup--p-anchor" target="_blank">follow me directly here at Medium</a> to stay up to date on my dev articles.</p><p name="f323" id="f323" class="graf graf--p graf-after--p graf--trailing">Holden</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@reedrehg" class="p-author h-card">Holden Rehg</a> on <a href="https://medium.com/p/7f10d0d5d824"><time class="dt-published" datetime="2019-02-16T18:15:51.096Z">February 16, 2019</time></a>.</p><p><a href="https://medium.com/@reedrehg/run-an-odoo-repl-ipython-prompt-7f10d0d5d824" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 31, 2020.</p></footer></article></body></html>