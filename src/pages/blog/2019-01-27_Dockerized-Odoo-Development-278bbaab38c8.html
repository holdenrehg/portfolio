<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Dockerized Odoo Development</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Dockerized Odoo Development</h1>
</header>
<section data-field="subtitle" class="p-summary">
Easier Odoo Development with Docker
</section>
<section data-field="description" class="p-summary">
Docker, in my opinion, is still the only real option for running isolated development systems for a team of engineers using varying operating systems while being able to deploy these isolated systems.
</section>
<section data-field="body" class="e-content">
<section name="d9bb" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c442" id="c442" class="graf graf--h3 graf--leading graf--title">Dockerized Odoo Development</h3><h4 name="e185" id="e185" class="graf graf--h4 graf-after--h3 graf--subtitle">Easier Development with Docker</h4></div><div class="section-inner sectionLayout--outsetColumn"><figure name="eca2" id="eca2" class="graf graf--figure graf--layoutOutsetCenter graf-after--h4"><img class="graf-image" data-image-id="0*tEWtT-zzLObZRVUX" data-width="4912" data-height="3264" data-unsplash-photo-id="KjNGa3HvGgY" data-is-featured="true" src="https://cdn-images-1.medium.com/max/1200/0*tEWtT-zzLObZRVUX"><figcaption class="imageCaption">The stereotypical shipping container photo for Docker-related articles, by <a href="https://unsplash.com/@timeasley?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@timeasley?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Tim Easley</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="b19b" id="b19b" class="graf graf--p graf-after--figure">This is a follow up to something I wrote about a couple of years ago when I was trying to go through the process of running dozens of applications on the same server. Looking back I wish I would have jumped into Docker sooner, but hindsight is 20/20.</p><h3 name="b6e9" id="b6e9" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">Why Docker?</strong></h3><p name="a5af" id="a5af" class="graf graf--p graf-after--h3">Docker, in my opinion, is still the only real option for running isolated development systems for a team of engineers using varying operating systems while being able to deploy those isolated systems from a local environment, to a development environment, to a production environment.</p><p name="2486" id="2486" class="graf graf--p graf-after--p">You have a few other tools out there like LXC but it’s not diverse enough.</p><p name="a5c0" id="a5c0" class="graf graf--p graf-after--p">Ultimately with these types of tools (virtualization, containers, virtual machines, etc.), we are just trying to solve a few problems that we run into on development teams.</p><p name="9870" id="9870" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">The Team and Example Project</strong></p><p name="7963" id="7963" class="graf graf--p graf-after--p">Think about 10 developers working on a team together to develop an awesome new web application using Python and Postgresql. Between these 10 developers, imagine they use 5 different operating systems. They use Ubuntu, Red Hat, Fedora, Windows, and macOS.</p><p name="727b" id="727b" class="graf graf--p graf-after--p">The Python app they are building integrates 3 open source projects behind the scenes running a chat application, queueing software, and a resource monitoring tool that only runs on Linux. The production and staging environments are Linux servers.</p><p name="08cf" id="08cf" class="graf graf--p graf-after--p">How do we get the application running on all 10 developers local environments? It’s possible, but not fun. Some people use virtual machines, some may have to use cloud servers for certain services, some dual boot their systems or use a separate laptop, etc.</p><p name="23a5" id="23a5" class="graf graf--p graf-after--p">And this is actually a common, pretty simple example. Think about more complex examples like a client-service business where each developer has between 5–20 projects on their local system at a time, different programming languages or different versions of 1 programming language, different database systems, different dependencies, etc.</p><p name="eb26" id="eb26" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">The Team’s Needs</strong></p><p name="1dba" id="1dba" class="graf graf--p graf-after--p">The team needs a development environment that does the following:</p><ul class="postList"><li name="2774" id="2774" class="graf graf--li graf-after--p">Isolates an operating system at a certain version, per service.</li><li name="cd05" id="cd05" class="graf graf--li graf-after--li">Isolates all dependencies at a certain version.</li><li name="fba7" id="fba7" class="graf graf--li graf-after--li">Runs essentially anywhere. Any OS, cloud or physical, production or local.</li><li name="adef" id="adef" class="graf graf--li graf-after--li">Performs well enough for developers to not rip their hair out.</li></ul><h3 name="4346" id="4346" class="graf graf--h3 graf-after--li"><strong class="markup--strong markup--h3-strong">What is Docker?</strong></h3><p name="5644" id="5644" class="graf graf--p graf-after--h3">At this point, it seems that most developers have at least run across Docker. Even if it’s just from looking at open source projects that provide instructions on running with Docker or seeing articles about if you don’t start using containers your living in prehistoric times (Docker is a good tool, but <strong class="markup--strong markup--p-strong">do what’s best for you and don’t bandwagon</strong> just for the sake of using the newest shit)</p><p name="0eee" id="0eee" class="graf graf--p graf-after--p">So for people who need a quick summary, let’s run through some different terms:</p><p name="b8ad" id="b8ad" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Virtualization</strong></p><p name="0e19" id="0e19" class="graf graf--p graf-after--p">There are different types of virtualization, but ultimately virtualization means the simulation of computer systems or environments on a single host system, <strong class="markup--strong markup--p-strong">isolated into their own space</strong>.</p><p name="86d9" id="86d9" class="graf graf--p graf-after--p">Imagine if you have a generic phone that has 4 buttons on it for iOS, Android, Blackberry, or Microsoft. You could “open up” your iOS system and take a couple of pictures before going back to the Android system to edit those two pictures.</p><p name="3d38" id="3d38" class="graf graf--p graf-after--p">Virtualization, in the simplest use case, let’s you do that with computers. If you are a macOS user who needs to run the newest Office Suite then you can simulate a Windows 10 system from your mac.</p><p name="2355" id="2355" class="graf graf--p graf-after--p">Your mac would be considered the host.</p><p name="80f7" id="80f7" class="graf graf--p graf-after--p">The windows system would be considered a guest operating system.</p><p name="dc46" id="dc46" class="graf graf--p graf-after--p">A tool called a hypervisor interfaces with physical hardware and distributes resources to each guest.</p><p name="b553" id="b553" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Virtual Machines</strong></p><p name="6031" id="6031" class="graf graf--p graf-after--p">You may have experience with tools like VirtualBox or VMWare Workstation for virtualization or even local development, but technically Docker does not use the same type of virtualization.</p><p name="b03b" id="b03b" class="graf graf--p graf-after--p">In practice, two factors that stand out with virtual machines, compared to containers, are:</p><ol class="postList"><li name="c013" id="c013" class="graf graf--li graf-after--p">Virtual Machines always provide a full operating system.</li><li name="9a53" id="9a53" class="graf graf--li graf-after--li">Virtual Machines take a performance hit because of the extra layers of software placed between the host system (your computer) and the guest system (the operating system running in the virtual machine.)</li></ol><p name="6b47" id="6b47" class="graf graf--p graf-after--li">Virtual machines are good in a way but also bad in a way. It meets some of the teams’ needs but they are <strong class="markup--strong markup--p-strong">not fast</strong> and they <strong class="markup--strong markup--p-strong">will not deploy as easily</strong>.</p><p name="bf58" id="bf58" class="graf graf--p graf-after--p">There’s a lot of details about resource sharing, networking, and hypervisors, hardware utilization, partitioning, etc. associated with explaining how virtual machines work behind the scenes. <a href="https://www.vmware.com/solutions/virtualization.html" data-href="https://www.vmware.com/solutions/virtualization.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">VMWare</a> has some good resources out there if you want to dig into those details.</p><p name="25a1" id="25a1" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Containers</strong></p><p name="3d45" id="3d45" class="graf graf--p graf-after--p">Finally, something Docker specific. So as you know, Docker does not use Virtual Machines or the definition of virtualization defined by Virtual Machines.</p><p name="87c1" id="87c1" class="graf graf--p graf-after--p">It uses containers. There are quite a few technical differences between containers and virtual machines, but you can visualize containers as micro virtual machines. Docker does not package up the container in the same way that a virtual machine does, with the entire guest operating system kernel, hypervisor, and hardware virtualization tooling, so we can create hundreds of these simple containers and network them together without the overhead of a virtual machine.</p><p name="3db0" id="3db0" class="graf graf--p graf-after--p">Remember that when running containers, they are still an isolated environment.</p><p name="d3bf" id="d3bf" class="graf graf--p graf-after--p">Your computer is the docker host.</p><p name="2031" id="2031" class="graf graf--p graf-after--p">Each container runs as its own “micro virtual machine”. You can treat it like a remote server in a way, by copying files to and from, shelling into the container, networking with the containers IP, etc.</p><p name="46c9" id="46c9" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Volumes</strong></p><p name="bd7c" id="bd7c" class="graf graf--p graf-after--p">A volume is a way to share data between the host (your computer) and a specific container. With each container being as close to stateless as possible, you can map data inside the container from your machine. You will see more about this below when we setup our <code class="markup--code markup--p-code">docker-compose.yml</code> file.</p><p name="a22e" id="a22e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Images</strong></p><p name="625d" id="625d" class="graf graf--p graf-after--p">Images are basically compiled containers. Containers are given instructions, defining how to set up the container from scratch, that look like:</p><figure name="c5a9" id="c5a9" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/holdenrehg/49d203ae6202dc5d831f2f3bcef83fbb.js"></script></figure><p name="0a2f" id="0a2f" class="graf graf--p graf-after--figure">Think about these like Chef recipes or server provisioning tools. It&#39;s telling Docker how to create a container so that the container is exactly the same for every developer and every environment. These are called Dockerfile’s.</p><p name="3e92" id="3e92" class="graf graf--p graf-after--p">There is a process of building the container from these files, packaging them up as an image, and pushing them to an image repository so that your team or our developers can use them. See <a href="https://hub.docker.com" data-href="https://hub.docker.com" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">hub.docker.com</a>.</p><h3 name="5cf1" id="5cf1" class="graf graf--h3 graf-after--p">Running Odoo On Docker</h3><p name="571c" id="571c" class="graf graf--p graf-after--h3">There’s much, much, much more to learn about docker and ecosystem that revolves around Docker, but hopefully, that gives you a rough idea about the basics.</p><p name="b63c" id="b63c" class="graf graf--p graf-after--p">Let’s get Odoo up and running now.</p><p name="3bb2" id="3bb2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Installing Docker and Docker Compose</strong></p><p name="19cd" id="19cd" class="graf graf--p graf-after--p">Make sure you have <a href="https://docs.docker.com/install/#supported-platforms" data-href="https://docs.docker.com/install/#supported-platforms" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Docker and Docker Compose installed</a>. For Linux based system, you can use your package manager:</p><pre name="ec40" id="ec40" class="graf graf--pre graf-after--p"># Using Ubuntu / Debian<br>$ sudo apt install docker docker-compose</pre><pre name="3e31" id="3e31" class="graf graf--pre graf-after--pre"># Using Redhat<br>$ sudo apt install docker docker-compose</pre><p name="616e" id="616e" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Creating Our Docker Compose File</strong></p><p name="bbd7" id="bbd7" class="graf graf--p graf-after--p">Without using docker, we know that we need a <a href="https://github.com/Yenthe666/InstallScript/blob/12.0/odoo_install.sh" data-href="https://github.com/Yenthe666/InstallScript/blob/12.0/odoo_install.sh" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">certain set of steps to create our local environment</a> for Odoo development:</p><p name="76ee" id="76ee" class="graf graf--p graf-after--p">All of that has been baked into a template for us already as a docker image (<a href="https://github.com/odoo/docker/blob/d0360678214b8f70970a2369a5a6b37981ab2c45/12.0/Dockerfile" data-href="https://github.com/odoo/docker/blob/d0360678214b8f70970a2369a5a6b37981ab2c45/12.0/Dockerfile" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">see the Dockerfile</a> for the steps followed). All we need to do is reference the docker hub image.</p><ol class="postList"><li name="a5b0" id="a5b0" class="graf graf--li graf-after--p">Make a folder on your system, which will become your project environment:</li></ol><pre name="a657" id="a657" class="graf graf--pre graf-after--li">$ mkdir -p ~/projects/odoo-docker<br>$ cd ~/projects/odoo-docker<br>$ touch docker-compose.yml<br>$ mkdir ./config &amp;&amp; touch config/odoo.conf<br>$ mkdir ./addons</pre><p name="96fe" id="96fe" class="graf graf--p graf-after--pre">2. Add the <code class="markup--code markup--p-code">./docker-compose.yml</code> contents:</p><p name="3aac" id="3aac" class="graf graf--p graf-after--p">I’ve created the sample <code class="markup--code markup--p-code">docker-compose.yml</code> file below. I haven’t talked about docker compose in this article yet, but it’s an additional tool created by docker to allow you to orchestrate multiple containers together. In the case of Odoo, we need the web application container but also the postgresql database container.</p><figure name="7438" id="7438" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/holdenrehg/cdecd40f39e145b42c4067eaa2eb2919.js"></script></figure><p name="7cac" id="7cac" class="graf graf--p graf-after--figure">3. Add the odoo.conf to <code class="markup--code markup--p-code">./config/odoo.conf</code> which will be mapped inside the container using volumes.</p><p name="e829" id="e829" class="graf graf--p graf-after--p">This is a very simple and fairly standard odoo configuration. The only part that may be confusing is the <code class="markup--code markup--p-code">db_host</code> . With docker, it will understand references to the container name (see in the docker-compose.yml above where we named our postgres container <code class="markup--code markup--p-code">db</code>). So it finds the proper IP for that container based on the name.</p><figure name="b974" id="b974" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/holdenrehg/76cd1970ea9788c34b05e936259564ba.js"></script></figure><p name="f42c" id="f42c" class="graf graf--p graf-after--figure">4. Run the containers</p><p name="96ec" id="96ec" class="graf graf--p graf-after--p">You can start up the container by running:</p><pre name="644e" id="644e" class="graf graf--pre graf-after--p">docker-compose up</pre><p name="d33a" id="d33a" class="graf graf--p graf-after--pre">You will see the output from the database and the odoo process. Once it has completed start up then you can access your instance at <a href="http://localhost:9000." data-href="http://localhost:9000." class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">http://localhost:9000.</a></p><p name="bfe0" id="bfe0" class="graf graf--p graf-after--p">And that’s it. Congrats. You have a local Odoo environment running inside docker containers.</p><figure name="46a0" id="46a0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ibi8k9s1YM_mLH4zVg2DKg.png" data-width="2915" data-height="1244" src="https://cdn-images-1.medium.com/max/800/1*ibi8k9s1YM_mLH4zVg2DKg.png"></figure><h3 name="b0a1" id="b0a1" class="graf graf--h3 graf-after--figure"><strong class="markup--strong markup--h3-strong">Notes On Workflow And Management</strong></h3><p name="ebcb" id="ebcb" class="graf graf--p graf-after--h3">This is just a simple tutorial on getting started with docker and Odoo, but there’s a lot you can do from here to make the workflow for you and your team a smoother process.</p><p name="bae0" id="bae0" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Get Used To The Daily Workflow</strong></p><p name="22b7" id="22b7" class="graf graf--p graf-after--p">We started up the container above with a simple command:</p><pre name="fc91" id="fc91" class="graf graf--pre graf-after--p">docker-compose up</pre><p name="1f91" id="1f91" class="graf graf--p graf-after--pre">And we can then stop it with Ctrl+C. But make sure to review the <code class="markup--code markup--p-code">docker</code> and <code class="markup--code markup--p-code">docker-compose</code> CLI tools to see everything that it can do:</p><pre name="a8d2" id="a8d2" class="graf graf--pre graf-after--p"># Start containers up in the background<br>docker-compose up -d</pre><pre name="c271" id="c271" class="graf graf--pre graf-after--pre"># Restart containers<br>docker-compose restart</pre><pre name="0052" id="0052" class="graf graf--pre graf-after--pre"># Stop containers<br>docker-compose stop</pre><pre name="254d" id="254d" class="graf graf--pre graf-after--pre"># Destroy containers (WARNING: This could mean data inside those containers as well)<br>docker-compose down</pre><pre name="d25f" id="d25f" class="graf graf--pre graf-after--pre"># Show container processes<br>docker ps<br>docker ps --filter name={container_name}</pre><pre name="a44b" id="a44b" class="graf graf--pre graf-after--pre"># Show container process stats<br>docker stats</pre><pre name="3f4a" id="3f4a" class="graf graf--pre graf-after--pre"># SSH into a container<br>docker exec -it {container_id} sh<br>docker exec -it $(docker ps -q --filter name={container_name}) sh<br>docker exec -u {user} -it {container_id} sh<br>docker exec -u root -it {container_id} bash</pre><pre name="7541" id="7541" class="graf graf--pre graf-after--pre"># Copy contents to container from host<br>docker cp ~/my/file {container_id}:~/myfile</pre><pre name="f528" id="f528" class="graf graf--pre graf-after--pre"># Copy contents from container to host<br>docker cp {container_id}:~/myfile ~/my/file</pre><pre name="6f71" id="6f71" class="graf graf--pre graf-after--pre"># Tail the process from a container<br>docker logs -f {container_id}</pre><p name="cc2d" id="cc2d" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Some Ideas On What To Do Next</strong></p><ul class="postList"><li name="0cd9" id="0cd9" class="graf graf--li graf-after--p">Create a project <code class="markup--code markup--li-code">make</code> process. If you can get to the point where any developer can <code class="markup--code markup--li-code">git pull</code> your project, run a single script or command, and have the application up and running. That’s ideal. With a setup like this, you could for example just add a <code class="markup--code markup--li-code">make.sh</code> script in the root of the project which would download any addons that you need.</li><li name="58b2" id="58b2" class="graf graf--li graf-after--li">Build your own docker image. You could have your own <code class="markup--code markup--li-code">my/odoo:12.0</code> docker image which you reference from the docker-compose.yml file and it has all the dependencies and tools that you always use configured and ready to go.</li><li name="ca9f" id="ca9f" class="graf graf--li graf-after--li">Auto-deploy your docker containers on repository push.</li><li name="cea4" id="cea4" class="graf graf--li graf-after--li">Automatically download sample or pre-seeded databases on container run.</li></ul><p name="445f" id="445f" class="graf graf--p graf-after--li">Do whatever is best for you and your team.</p><h3 name="b4dc" id="b4dc" class="graf graf--h3 graf-after--p">Thanks For Reading</h3><p name="6754" id="6754" class="graf graf--p graf-after--h3"><a href="https://bustererp.com" data-href="https://bustererp.com" class="markup--anchor markup--p-anchor" rel="nofollow noopener noopener" target="_blank">Sign up for my new project called Buster</a> then let me know your thoughts.</p><p name="7341" id="7341" class="graf graf--p graf-after--p"><a href="https://twitter.com/reedrehg" data-href="https://twitter.com/reedrehg" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener nofollow noopener nofollow noopener noopener" target="_blank">Follow me on Twitter</a> for random thoughts and articles about business software and software development. Or <a href="https://medium.com/@reedrehg" data-href="https://medium.com/@reedrehg" class="markup--anchor markup--p-anchor" target="_blank">follow me directly here at Medium</a> to stay up to date with my articles.</p><p name="9865" id="9865" class="graf graf--p graf-after--p graf--trailing">Holden</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@reedrehg" class="p-author h-card">Holden Rehg</a> on <a href="https://medium.com/p/278bbaab38c8"><time class="dt-published" datetime="2019-01-27T16:39:13.127Z">January 27, 2019</time></a>.</p><p><a href="https://medium.com/@reedrehg/easier-odoo-development-278bbaab38c8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 31, 2020.</p></footer></article></body></html>